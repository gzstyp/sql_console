select name,GROUP_CONCAT(profession) profession,GROUP_CONCAT(profession_total) profession_total from (
    select sa.name,sd.name profession,lt.profession_total from (
    select city_id,profession,count(profession) profession_total from bs_employee
    where sampling_date >= '2020-12-07' and sampling_date <= '2020-12-08'
    group by profession,city_id ORDER BY profession ASC) lt
left join sys_area sa on sa.kid = lt.city_id
left join sys_dict sd on sd.KID = lt.profession) gt group by name;





























































































